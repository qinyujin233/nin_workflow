(function(e){function n(n){for(var o,i,s=n[0],c=n[1],l=n[2],d=0,u=[];d<s.length;d++)i=s[d],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&u.push(a[i][0]),a[i]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(e[o]=c[o]);p&&p(n);while(u.length)u.shift()();return r.push.apply(r,l||[]),t()}function t(){for(var e,n=0;n<r.length;n++){for(var t=r[n],o=!0,s=1;s<t.length;s++){var c=t[s];0!==a[c]&&(o=!1)}o&&(r.splice(n--,1),e=i(i.s=t[0]))}return e}var o={},a={app:0},r=[];function i(n){if(o[n])return o[n].exports;var t=o[n]={i:n,l:!1,exports:{}};return e[n].call(t.exports,t,t.exports,i),t.l=!0,t.exports}i.m=e,i.c=o,i.d=function(e,n,t){i.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,n){if(1&n&&(e=i(e)),8&n)return e;if(4&n&&"object"===typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(i.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)i.d(t,o,function(n){return e[n]}.bind(null,o));return t},i.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(n,"a",n),n},i.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},i.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=n,s=s.slice();for(var l=0;l<s.length;l++)n(s[l]);var p=c;r.push([0,"chunk-vendors"]),t()})({0:function(e,n,t){e.exports=t("56d7")},"2a9d":function(e,n,t){"use strict";var o=t("7ad8"),a=t.n(o);a.a},"56d7":function(e,n,t){"use strict";t.r(n);t("e260"),t("e6cf"),t("cca6"),t("a79d");var o=t("2b0e"),a=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{ref:"content",staticClass:"containers"},[t("div",{ref:"canvas",staticClass:"canvas"}),t("div",{staticClass:"panel",attrs:{id:"js-properties-panel"}}),t("ul",{staticClass:"buttons"},[t("li",[t("a",{ref:"saveDiagram",attrs:{href:"javascript:",title:"保存为bpmn"}},[e._v("保存为bpmn")])]),t("li",[t("a",{ref:"saveSvg",attrs:{href:"javascript:",title:"保存为svg"}},[e._v("保存为svg")])]),t("li",[t("Button",{attrs:{type:"primary"},on:{click:e.saveData}},[e._v("保存到服务器")])],1)])])},r=[],i=(t("4160"),t("96cf"),t("1da1")),s=t("bc3a"),c=t.n(s),l=t("7024"),p=t("1cdc6"),d=t.n(p),u=t("04be"),m=t.n(u),f='<?xml version="1.0" encoding="UTF-8"?>\n<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:omgdi="http://www.omg.org/spec/DD/20100524/DI" xmlns:omgdc="http://www.omg.org/spec/DD/20100524/DC" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="sid-38422fae-e03e-43a3-bef4-bd33b32041b2" targetNamespace="http://bpmn.io/bpmn" exporter="bpmn-js (https://demo.bpmn.io)" exporterVersion="5.1.2">\n<process id="Process_1" isExecutable="false">\n    <startEvent id="StartEvent_1y45yut" name="开始">\n    <outgoing>SequenceFlow_0h21x7r</outgoing>\n    </startEvent>\n    <task id="Task_1hcentk">\n    <incoming>SequenceFlow_0h21x7r</incoming>\n    </task>\n    <sequenceFlow id="SequenceFlow_0h21x7r" sourceRef="StartEvent_1y45yut" targetRef="Task_1hcentk" />\n</process>\n<bpmndi:BPMNDiagram id="BpmnDiagram_1">\n    <bpmndi:BPMNPlane id="BpmnPlane_1" bpmnElement="Process_1">\n    <bpmndi:BPMNShape id="StartEvent_1y45yut_di" bpmnElement="StartEvent_1y45yut">\n        <omgdc:Bounds x="152" y="102" width="36" height="36" />\n        <bpmndi:BPMNLabel>\n        <omgdc:Bounds x="160" y="145" width="22" height="14" />\n        </bpmndi:BPMNLabel>\n    </bpmndi:BPMNShape>\n    <bpmndi:BPMNShape id="Task_1hcentk_di" bpmnElement="Task_1hcentk">\n        <omgdc:Bounds x="240" y="80" width="100" height="80" />\n    </bpmndi:BPMNShape>\n    <bpmndi:BPMNEdge id="SequenceFlow_0h21x7r_di" bpmnElement="SequenceFlow_0h21x7r">\n        <omgdi:waypoint x="188" y="120" />\n        <omgdi:waypoint x="240" y="120" />\n    </bpmndi:BPMNEdge>\n    </bpmndi:BPMNPlane>\n</bpmndi:BPMNDiagram>\n</definitions>',h={name:"",components:{},created:function(){},mounted:function(){this.init()},data:function(){return{bpmnModeler:null,container:null,canvas:null,loading:!0,xmlUrl:"",defaultXmlStr:f}},methods:{init:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.loading=!0,e.xmlUrl="",console.log(e.xmlUrl),e.loading=!1,e.$nextTick((function(){e.initBpmn()}));case 5:case"end":return n.stop()}}),n)})))()},initBpmn:function(){var e=this.$refs.canvas;this.bpmnModeler=new l["a"]({container:e,propertiesPanel:{parent:"#js-properties-panel"},additionalModules:[m.a,d.a]}),this.createNewDiagram()},createNewDiagram:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var t,o,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t=e,o="",""!==e.xmlUrl){n.next=7;break}o=e.defaultXmlStr,e.transformCanvas(o),n.next=13;break;case 7:return n.next=9,c()({method:"get",timeout:12e4,url:t.xmlUrl,headers:{"Content-Type":"multipart/form-data"}});case 9:a=n.sent,console.log(a),o=a["data"],e.transformCanvas(o);case 13:case"end":return n.stop()}}),n)})))()},saveSVG:function(e){this.bpmnModeler.saveSVG(e)},saveDiagram:function(e){this.bpmnModeler.saveXML({format:!0},(function(n,t){e(n,t)}))},transformCanvas:function(e){var n=this;this.bpmnModeler.importXML(e,(function(e){e?console.error(e):console.log("创建成功!");var t=n.bpmnModeler.get("canvas");t.zoom("fit-viewport")}))},saveData:function(){this.bpmnModeler.saveXML({format:!0},(function(e,n){c.a.get("/bpmn/save",{params:{bpmnXml:n,modelName:123}}).then((function(e){console.log(e)})).catch((function(e){console.log(e)}))}))}},success:function(){console.log("创建成功!")},addBpmnListener:function(){var e=this,n=this.$refs.saveDiagram,t=this.$refs.saveSvg;this.bpmnModeler.on("commandStack.changed",(function(){e.saveSVG((function(n,o){e.setEncoded(t,"diagram.svg",n?null:o)})),e.saveDiagram((function(t,o){e.setEncoded(n,"diagram.bpmn",t?null:o)}))}))},addModelerListener:function(){var e=this,n=["shape.added","shape.move.end","shape.removed"];n.forEach((function(n){e.bpmnModeler.on(n,(function(){"shape.added"===n?console.log("新增了shape"):"shape.move.end"===n?console.log("移动了shape"):"shape.removed"===n&&console.log("删除了shape")}))}))},addEventBusListener:function(){var e=this,n=this.bpmnModeler.get("eventBus"),t=["element.click","element.changed"];t.forEach((function(t){n.on(t,(function(n){console.log(n),n&&"bpmn:Process"!=n.element.type&&("element.changed"===t?e.elementChanged(n):"element.click"===t&&console.log("点击了element"))}))}))},isInvalid:function(e){return null===e||void 0===e||""===e},isSequenceFlow:function(e){return"bpmn:SequenceFlow"===e},elementChanged:function(e){var n=this.getShape(e.element.id);if(console.log(n),!n)return console.log("无效的shape"),void console.log("删除了shape和connect");this.isInvalid(n.type)||this.isSequenceFlow(n.type)&&console.log("改变了线")},getShape:function(e){var n=this.bpmnModeler.get("elementRegistry");return n.get(e)},setEncoded:function(e,n,t){var o=encodeURIComponent(t);t&&(e.className="active",e.href="data:application/bpmn20-xml;charset=UTF-8,"+o,e.download=n)}},g=h,v=(t("2a9d"),t("2877")),b=Object(v["a"])(g,a,r,!1,null,"2f1c2f56",null),w=b.exports;t("f910"),t("2c13"),t("e7f6"),t("1e9e"),t("e278");o["a"].config.productionTip=!1,new o["a"]({render:function(e){return e(w)}}).$mount("#app")},"7ad8":function(e,n,t){}});